\chapter{Introduction}
\label{ch:Introduction}

Monitoring and assessment of human body motion, in particular the analysis of gait, has become an integral part of medical diagnosis, therapy techniques, and rehabilitation \cite{tao_gait_2012}. \emph{Gait analysis} involves the measurement and assessment of quantitative parameters that characterise human locomotion. First research in this field was conducted in the late 19\textsuperscript{th} century \cite{tao_gait_2012}. The quantitative data enable physicians to diagnose a variety of medical conditions, validate treatment success, set goals in rehabilitation and regularly alter them when necessary. However, standard gait analysis based on multi-camera motion capture systems and force platforms require specialised gait laboratories, expensive equipment, and lengthy setup times. Moreover, the assessments of gait based on measurements performed in clinical settings might not be truly representative \cite{bonato_advances_2005}.

Unobtrusive wearable sensors mitigate the aforementioned limitations. Low cost sensors have been employed in clinical and home environments to constantly monitor the movements of patients \cite{godfrey_direct_2008}. The progressive miniaturisation of inertial and magnetic field sensors has made them more acceptable to patients and has consequently lead to an increasingly pervasive adoption for medical applications \cite{wee_soon_ambulatory_2008}, especially in the truly representative home environment.  Among others, wearable inertial and magnetic sensors are used to assess \emph{gait kinematics}. An extensive description is presented in Section \ref{sec:MARG_sensors_medical}. \emph{Kinematics} is a branch of classical mechanics, which is concerned with motion of objects without reference to the forces causing the motion. Position, velocity and acceleration are of particular interest in kinematics.

Determining the position of the legs is essential in gait analysis. The position, i.\,e. the orientation, can be estimated from inertial data. For the application in health care accurate orientation estimates are crucial. A high degree of precision based on data from miniaturised sensors necessitates adequate signal processing, in order to mitigate the influence of disruptive factors, such as bias instability and noise, among others. The signal processing of inertial and magnetic data encompasses calibration, adaptive filtering, and sensor fusion. The latter two are a part of this work.

\section{Motivation}

Gait analysis provides a powerful means to derive diagnostic information about the functioning of the musculoskeletal, vestibular, and central and peripheral nervous system \cite{bennett_extended_2013}. Accurate orientation estimation of the extremities by means of wearable inertial and magnetic field sensors allows objective assessment of human gait and can therefore benefit medical applications without the aforementioned constraints of camera based motion capture systems. A more reliable and more precise orientation estimation would enable an even more informative gait analysis. A multitude of applications in the medical field would profit from such an enhanced gait analysis \cite{wong_clinical_2007}. The direct relation to health care and the resulting possibility to improve the quality of life of many patients was the motivation for this thesis.

\section{Goals}

The goal of this thesis was implementing a new Kalman filter based orientation algorithm proposed by \citeauthor{bennett_motion_2014} in \cite{bennett_motion_2014}. Thus the estimation of orientation angles of the human leg by means of inertial and magnetic sensors should be improved. The filter algorithm should be implemented using \textsc{Matlab}\textsuperscript{\textregistered} and validated against existing algorithms by comparing their respective \gls{RMSE}. An existing system for human body motion analysis based on wearable sensors was available, so that no new hardware had to be developed to gather the movement data. A detailed description of the so-called GaitWatch system is found at the end of Chapter \ref{ch:MARG}.

\section{Methodology}

This document presents my work within the overall project in a chronological order. Subsequent to the previous introductory overview of the topic and the definition of the project objectives, this chapter ends with a description of the state of the art. To accomplish the tasks defined in the previous section, I had to acquire knowledge regarding various subjects. Chapters 2 to 4 outline the necessary fundamentals of MARG sensors, orientation estimation and digital filters, respectively.  This enables comprehension of the overall project, even for readers that are not familiar with some of the subjects. Those readers are referred to Chapters 2 to 4 at this point, before reading the state of the art. The actual implementation of the Kalman filter, including a prior theoretical design is given in Chapter 5. This chapter also encompasses the experimental setup, the results and a discussion of the latter. Finally, Chapter 6 covers conclusions and future work.

I implemented the filter algorithm in the numerical computing environment \textsc{Matlab}\textsuperscript{\textregistered}. As additional means to communicate with my supervisor and in order to enable him to follow the progress of my work at any time we used Pivotal Tracker, a tool for agile project management, and GitHub, a repository hosting service based on the distributed version control system Git. This thesis was written in \LaTeX{}.
 
\section{State of the Art}\label{sec:state_of_the_art}

There are several research works in the literature dealing with orientation estimation by means of inertial sensors. Kalman filters have been used successfully to improve the estimation of orientation angles from inertial data. The state of the art at the commencement of the project is described below. Subsequently, applications of wearable inertial sensors in health care and current attempts to revolutionise medical research assisted by those sensors are presented.

\subsection{Kalman Filtering in Orientation Estimation} \label{sec:state_of_the_art_kalman}

Considering the fact that inertial and magnetic field sensors are used to establish objective body motion parameters that affect medical diagnosis, therapy, and rehabilitation, the necessity of a high level of accuracy becomes obvious. In order to obtain precise orientation estimates from sensor data it is essential to mitigate the effects of measurement noise and to combine the advantages of different  sensors through sensor fusion. Therefore, a wide variety of Kalman filter algorithms have been developed in the literature. It is common practice to fuse accelerometer and gyroscope measurements to mitigate their respective drawbacks and thus obtain more accurate orientation estimates.

\citeauthor{Luinge_orientation_acc_gyro_99} \cite{Luinge_orientation_acc_gyro_99} alleged that the gravitational component of the acceleration signal has a greater magnitude than the component caused by motion for many human movements. They estimated the tilt angle, which is defined as the angle between the sensor axes and the vertical. The separate estimates from an accelerometer and a gyroscopes were fused with a Kalman filter. To test their method they moved the sensors around by hand for 30 seconds and then put it in a known position. They orientation obtained by integrating the angular rate only served as a reference. They concluded that a fusion of accelerometer and gyroscope signals accounts for a considerable improvement of the orientation estimation. This approach lacks of dynamical comparison since it only compares the errors at specific static positions.

Due to human motion intensity usually being subject to change, \citeauthor{olivares_vicente_signal_2013} implemented a \emph{gated Kalman filter} in \cite{olivares_vicente_signal_2013}. They modelled linear acceleration during intense motion as noise and improved the performance of the Kalman filter by dynamically adjusting the variance of both the process and measurement noise, according to the motion intensity. Therefore, they applied a \gls{LTSD} and set the variance between two predefined values. Then, the gated Kalman filter fused information from the accelerometer and the gyroscope signals. With this method they improved the adapting capability of the filter and consequently the precision of the orientation estimation.

\citeauthor{bennett_motion_2014} demonstrated in \cite{bennett_motion_2014} that accelerometer angle estimates are inaccurate for typical motions of the leg. They affirmed the need to decouple the acceleration due to motion from the acceleration due to gravity, since the former cannot be neglected during fast motions. Therefore, they deployed a \emph{kinematic model} of the leg to determine the acceleration that occurs due to motion and corrected the acceleration signal accordingly. An extended Kalman filter fused the corrected acceleration data with measurements of a gyroscope. This method improved upon the raw acceleration method during motion and at rest by an 83\% smaller \gls{RMSE}. Their proposed approach is the foundation of the filter algorithm implemented in Section \ref{sec:theoretical_design}.

\subsection{Wearable Sensors in Health Care}\label{sec:MARG_sensors_medical}

Inertial sensors can be found in smart phones, fitness trackers, and other wearable devices, among others. With increasing capability of body sensor networks and wearable computing, they have become prevalent in research environments for estimation and tracking of human body motion \cite{bennett_motion_2014}. They are used in activity monitoring \cite{veltink_detection_96, najafi_ambulatory_03, ermes_sports_08}, rehabilitation \cite{giggins_rehabilitation_13, lupinski_ligament_11}, sports training \cite{bonnet_squat_13, ermes_sports_08}, and localisation \cite{hoflinger_localization_13, Bennett_distance_13}.

Many neurodegenerative diseases such as, for instance, Parkinson's disease, impair stable stance and gait and reduce the patient's mobility. Thus, they diminish the quality of life significantly. \emph{Parkinson's disease} is a movement disorder that is characterised by marked slow movements, tremors, and unstable posture. Especially in advanced stages of the disease many patients exhibit an episodic, brief inability to step, which delays gait initiation or interrupts ongoing gait. This phenomenon is called freezing of gait. With the progression of the disease, Parkinson's patients are increasingly dependent on help from others to accomplish daily tasks. One of the most reliable diagnostic criterion of the disease is gait \cite{tao_gait_2012}. Hence, wearable motion sensors have been used successfully to classify the severity of the disease objectively \cite{mancini_anticipatory_2009, palmerini_feature_2011, klerk_long-term_2009}.

Stroke patients, who regained their walking ability, need to undergo rehabilitation to recover their independent mobility. Ambulatory gait analysis provides a means to assess the function of the lower extremities of hemiparetic post-stroke patients and follow the progress of rehabilitation \cite{tao_gait_2012, saremi_reliability_2006}. In addition, the presence of neurologic gait abnormalities is used as a significant predictor of the risk of development of dementia \cite{verghese_dementia_2002}. Also, emergency falls of elderly people can be detected \cite{bourke_threshold-based_2008, bourke_assessment-waist_2010, bourke_fall_detection_2008}.

\subsection{The Impact of Wearable Sensors on Medical Research}

The fact that most of the current smartphones come equipped with inertial and magnetic sensors and powerful processor has opened up new possibilities for medical research. The number of smartphones across the globe is predicted to surpass two billion in 2016 \cite{emarketer_smartphones}. Recently, large companies have developed software that takes advantage of the associated potential to revolutionise medical research.

In August 2014, the Michael J. Fox Foundation for Parkinson’s Research and Intel Corporation \cite{Intel_2013} announced a collaborative research study on objective measurement of Parkinson symptoms. They aim to collect movement data of thousands of patients twenty-four seven at over 300 samples per second by means of unobtrusive wearable devices and store them on a big data analytics platform. The data platform, deployed on a cloud infrastructure, supports an analytics application that processes the data and detects changes in real time. Thus, by detecting anomalies, the progression of the disease can be measured objectively without the need for scientists to focus on the underlying computing technologies. Physicians and researchers are intended to have access to the data as well as be able to submit their own anonymised patient data for analysis. According to \cite{Intel_2013} the correlation of data that quantifies symptoms such as slowness of movement, tremor, and sleep quality with molecular data could advance drug development and provide a deeper insight into the clinical course of Parkinson's disease.

In March 2015, \citeauthor{Apple_2015} announced a platform-independent, open source software framework called ResearchKit \cite{Apple_2015} that, amongst others, takes advantage of the MARG sensors in the iPhone to track movement of patients in daily life. Thus medical researchers obtain robust data with far more regularity than it was possible when patients complete tasks at hospitals or other research facilities in irregularly intervals. Moreover, according to \citeauthor{Apple_2015} ResearchKit simplifies recruiting participants from all over the world, which results in a more varied study group that provides a more useful representation of the population. Together with the University of Rochester and Sage Bionetworks they announced the iPhone app `mPower' \cite{mpower}, which measures balance and gait of Parkinson patients to help researchers better understand how various symptoms are connected to Parkinson's disease.

